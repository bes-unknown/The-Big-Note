\section{初等集合论}

朴素集合论认为

\begin{axiom}
    对于任意性质 \(P\) 均有 \(Y = \{x : P(x)\}\) 为集合.
\end{axiom}

然而随后提出的 Russell 悖论 (Russell's paradox) 给出了性质 \(X: X \notin X\) 的集合 \(X\) 不存在, 人们开始探索公理化集合论的道路. 

\subsection{von Neumann-Bernays-Gödel 公理}

von Neumann-Bernays-Gödel 公理系统的核心是类 (class) 与元素 (element), \(A\) 是 \(B\) 的元素用符号 \(A \in B\) 标记,
其否定自然使用 \(\notin\) 标记, 一个类可以作为另一个类的元素.

\begin{definition}
    两个类 \(A\) 与 \(B\) 相等, 记作 \(A = B\), 当且仅当 \(A\) 与 \(B\) 有相同的元素, 其否定记为 \(A \neq B\).

    \[
        (X = Y) := \forall Z (Z \in X \iff Z \in Y)
    \]
\end{definition}

\begin{corollary}
    显见以下公式:

    \begin{enumerate}
        \item \(\forall X (X = X)\)
        \item \(\forall X \forall Y (X = Y \implies Y = X)\)
        \item \(\forall X \forall Y \forall Z ((X = Y \land Y = Z) \implies X = Z)\)
    \end{enumerate}
\end{corollary}

\begin{definition}
    一个类 \(A\) 是另一个类 \(B\) 的子类, 记作 \(A \subseteq B\), 当且仅当 \(A\) 的所有元素都是 \(B\) 的元素, 其否定记为 \(A \nsubseteq B\).

    \[
        (X \subseteq Y) := \forall Z (Z \in X \implies Z \in Y)
    \]

    我们用 \(A \subset B\) 表示 \(A \subseteq B \land A \neq B\).
\end{definition}

\begin{corollary}
    \[
        (X \subseteq Y) \land (Y \subseteq X) \iff (X = Y)
    \]
\end{corollary}

\begin{axiom}[Axiom of Equality]
    \setlabel {Axiom of Equality}
    \label {axiom:NBG Axiom of Equality}
    \[
        \forall X \forall Y (X = Y \implies \forall Z (X \in Z \iff Y \in Z))
    \]
\end{axiom}

\begin{definition}[集合]
    一个类 \(X\) 称集合 (set), 当且仅当 \(\exists Y (X \in Y)\), 本节中我们用小写字母 \(x, y, z, \dots\) 表示集合, 用大写字母 \(X, Y, Z, \dots\) 表示类.
\end{definition}

\begin{definition}[真类]
    一个类 \(X\) 称真类 (proper class), 当且仅当 \(X\) 不是集合, 常用粗体字母 \(\mathbf{X}, \mathbf{Y}, \mathbf{Z}, \dots\) 表示真类.
\end{definition}

\begin{axiom}[Axiom of Pair]
    \setlabel {Axiom of Pair}
    \label {axiom:NBG Axiom of Pair}
    \[
        \forall x \forall y \exists z \forall u (u \in z \iff (u = x \lor u = y))
    \]
\end{axiom}

上述公理展开可得 \(\forall x \forall y ((\exists X \exists Y (x \in X \land y \in Y)) \implies \exists z \exists Z (z \in Z \land \forall u (u \in Z \iff (u = x \lor u = y))))\),
记集合 \(z = \{x,y\}\), 特别的, 当 \(x = y\) 时, 我们记 \(z = \{x\}\).

为了方便叙述, 我们常常忽略公式最前的 \(\forall\)

\begin{corollary}
    显见以下公式:

    \begin{enumerate}
        \item \(((x = u \land y = v) \implies \{x,y\} = \{u,v\})\)
        \item \(\{x,y\} = \{y,x\}\).
        \item \(x = y \iff \{x\} = \{y\}\).
        \item \(x = y \iff \forall Z (x \in Z \iff y \in Z)\).
    \end{enumerate}
\end{corollary}

\begin{definition}[有序对]
    \label {definition:Kuratowski ordered pair}
    有序对 (ordered pair) \((x,y)\) 定义为 \(\{\{x\},\{x,y\}\}\).
\end{definition}

\begin{lemma}
    有序对的有序体现在其性质 \((x,y) = (u,v) \iff (x = u \land y = v)\).

    \begin{proof}
        \((\therefore)\) 显然.

        \((\implies)\) 若 \(x \neq u\), 则 \(\{x\} \neq \{u\}\), 依赖 \ref{axiom:NBG Axiom of Pair}
        \(\{x\} \in (x,y) = (u,v)\), 从而 \(u \in \{u, v\} = \{x\}\), 矛盾.

        若 \(x = u \land y \neq v\), 只需证明 \(a = b \iff \{c,a\} = \{c,b\}\), 
        由 \ref{axiom:NBG Axiom of Pair} 知 \(a \in \{c,a\} = \{c,b\}\) 从而 \(a = c\), 同理, 
        \(b = c\), 矛盾.
    \end{proof}
\end{lemma}

\begin{definition}[有序三元对]
    \label {definition:ordered triple}
    有序三元对 (ordered triple) \((x,y,z)\) 定义为有序对 \(((x,y),z)\).
\end{definition}

\begin{definition}[二元关系]
    \label {definition:binary relation}
    类 \(R\) 称二元关系 (binary relation), 当且仅当 \(R\) 是有序对的集合, 记作 \(\mathbf{isbinrel} (R)\).

    \[
        \mathbf{isbinrel} (R) \iff \forall z (z \in R \implies \exists x \exists y (z = (x,y)))
    \]
\end{definition}

在不久的将来, 我们将用二元关系定义映射.

\begin{axiom}[Axiom of Membership]
    \setlabel {Axiom of Membership}
    \label {axiom:NBG Axiom of Membership}
    \[
        \exists \mathfrak{E} \forall z (z \in \mathfrak{E} \iff \exists x \exists y (z = (x,y) \land x \in y))
    \]
\end{axiom}

\begin{axiom}[Axiom of Domain]
    \setlabel {Axiom of Domain}
    \label {axiom:NBG Axiom of Domain}
    \[
        \forall X \exists D \forall x (x \in D \iff \exists y ((x,y) \in X))
    \]
\end{axiom}

\begin{definition}
    \label {definition:domain}
    上述定义中类 \(D\) 称为 \(X\) 的定义域 (domain), 记作 \(\mathbf{dom} (X)\).
\end{definition}

\begin{definition}
    \label {definition:universe}
    定义 \(\mathfrak{U} := \mathbf{dom} (\mathfrak{E})\), 称为宇宙 (universe), 注意到 \(\forall x (x \in \{x\})\),
    从而 \(\forall x (x \in \mathfrak{U})\).
\end{definition}

\begin{corollary}
    \[
        \mathbf{dom} (\mathfrak{U}) = \mathfrak{U}
    \]
\end{corollary}

\begin{axiom}[Axiom of Difference]
    \setlabel {Axiom of Difference}
    \label {axiom:NBG Axiom of Difference}
    \[
        \forall X \forall Y \exists D \forall x (x \in D \iff (x \in X \land x \notin Y))
    \]
\end{axiom}

\begin{definition}
    \label {definition:difference of two classes}
    上述定义中类 \(D\) 称为 \(X\) 与 \(Y\) 的差集 (difference), 记作 \(X \setminus Y\).
\end{definition}

\begin{definition}
    \label {definition:intersection of two classes}
    定义 \(X \cap Y := X \setminus (X \setminus Y)\), 称为 \(X\) 与 \(Y\) 的交集 (intersection).
\end{definition}

\begin{definition}
    \label {definition:union of two classes}
    定义 \(X \cup Y := \mathfrak{U} \setminus ((\mathfrak{U} \setminus X) \cap (\mathfrak{U} \setminus Y))\), 称为 \(X\) 与 \(Y\) 的并集 (union).
\end{definition}

\begin{definition}
    \label {definition:symmetric difference of two classes}
    定义 \(X \triangle Y := (X \setminus Y) \cup (Y \setminus X)\), 称为 \(X\) 与 \(Y\) 的对称差 (symmetric difference).
\end{definition}

\begin{definition}
    \label {definition:empty class}
    定义 \(\varnothing := \mathfrak{U} \setminus \mathfrak{U}\), 称为空类 (empty class), 根据 \ref{axiom:ZF Axiom of Infinity} 空类是集合 (空集, empty set).
\end{definition}

\begin{corollary}
    \[
        \forall E (\varnothing = E \setminus E)
    \]

    \begin{proof}
        运用 \ref{axiom:NBG Axiom of Equality} 即可.
    \end{proof}
\end{corollary}

\begin{axiom}[Axiom of Product]
    \setlabel {Axiom of Product}
    \label {axiom:NBG Axiom of Product}
    \[
        \forall X \forall Y \exists P \forall z (z \in P \iff \exists x \exists y (z = (x,y) \land x \in X \land y \in Y))
    \]
\end{axiom}

\begin{definition}
    \label {definition:product of two classes}
    上述定义中类 \(P\) 称为 \(X\) 与 \(Y\) 的积 (product), 记作 \(X \times Y\).
\end{definition}

\begin{definition}
    定义宇宙的积 \(\mathfrak{U} \times \mathfrak{U} := \ddot {\mathfrak{U}}\),
    此时 \(\mathbf{isbinrel} (R) \iff R \subseteq \ddot {\mathfrak{U}}\).
\end{definition}

\begin{axiom}[Axiom of Inversion]
    \setlabel {Axiom of Inversion}
    \label {axiom:NBG Axiom of Inversion}
    \[
        \forall X \exists I \forall z (z \in I \iff \exists x \exists y (z = (x,y) \land (y,x) \in X))
    \]
\end{axiom}

\begin{axiom}[Axiom of Cycle]
    \setlabel {Axiom of Cycle}
    \label {axiom:NBG Axiom of Cycle}
    \[
        \forall X \exists C \forall t (t \in C \iff \exists x \exists y \exists z (t = (z,x,y) \land (x,y,z) \in X))
    \]
\end{axiom}

\begin{definition}
    由上述公理定义的 \(I\) 记作 \(X^{-1}\), 称为 \(X\) 的逆 (inverse), \(C\) 记作 \(X^{\circlearrowright}\), \(X^{\circlearrowleft} := {(X^{\circlearrowright})}^{\circlearrowright}\).
\end{definition}

\begin{definition}
    \label {definition:range}
    定义 \(\mathbf{ran} (X) := \mathbf{dom} (X^{-1})\), 称为 \(X\) 的值域 (range).
\end{definition}

\begin{definition}
    \label{definition:union of classes}
    定义类 \(X\) 的并 (union) \(\bigcup X := \{z : \exists y \in X (z \in y)\}\).
    \label{definition:intersection of classes}
    定义类 \(X\) 的交 (intersection) \(\bigcap X := \{z : \forall y \in X (z \in y)\}\).
    \label{definition:power class}
    定义类 \(X\) 的幂 (power) \(\mathcal{P} (X) := \{Y : Y \subseteq X\}\).

    这里用到对类的表示方法, \(\{x : \phi (x)\}\) 表示满足条件 \(\phi (x)\) 的所有元素的类.

    \begin{proof}
        存在性依次由以下三者给出:

        \[
            \bigcup X = \mathbf{dom} (\mathfrak{E} \cap (\mathfrak{U} \times X))
        \]

        \[
            \bigcap X = \mathfrak{U} \setminus \mathbf{dom} ((\ddot {\mathfrak{U}} \setminus \mathfrak{E}) \cap (\mathfrak{U} \times X))
        \]

        \[
            \mathcal{P} (X) = \mathfrak{U} \setminus \mathbf{dom} (\mathfrak{E}^{-1} \cap (\mathfrak{U} \times (\mathfrak{U} \setminus X)))
        \]
    \end{proof}
\end{definition}

\begin{corollary}
    \[
        \mathcal{P} (\mathfrak{U}) = \mathfrak{U}
    \]
\end{corollary}

\begin{definition}
    \label {definition:image of a class}
    给出类 \(X\) 与二元关系 \(R\), 定义 \(X\) 在 \(R\) 下的像 (image) \(R[X] := \{y : \exists x \in X ((x,y) \in R)\} = \mathbf{ran} [R \cap (X \times \mathfrak{U})]\).

    \label {definition:preimage of a class}
    同理定义其逆像 (preimage) \(R^{-1}[X]\).
\end{definition}

\begin{definition}
    \label {definition:composition of two classes}
    给出二元关系 \(F, G\), 定义 \(F\) 与 \(G\) 的复合 (composition) \(F \circ G := \{(x,z) : \exists y ((x,y) \in G \land (y,z) \in F)\}\).

    \begin{proof}
        \[
            F \circ G = \mathbf{dom} ({(G^{-1} \times \mathfrak{U})}^{\circlearrowleft} \cup {(F^{-1} \times \mathfrak{U})}^{\circlearrowright})
        \]
    \end{proof}
\end{definition}

\begin{definition}
    \label {definition:function (set)}
    映射 (function) \(f\) 定义为满足 \((x,y) \in f \land (x,y^\prime) \in f \implies y = y^\prime\) 的二元关系, 记作 \(\mathbf{isfunc} (f)\).

    在存在 \(y\) 的情况下我们记 \(f(x)\) 为唯一的 \(y\) 使得 \((x,y) \in f\), 称为 \(f\) 在 \(x\) 处的值 (value).
\end{definition}

\begin{definition}
    \label {definition:injective (set)}
    单射 (injective) 指代 \(f, f^{-1}\) 都是映射的二元关系 \(f\).
\end{definition}

\begin{corollary}
    给出映射 \(F, G\), \(F \circ G\) 也是映射.
\end{corollary}

接下来从类转向集合, 定义集合的操作与要求.

\begin{axiom}[Axiom of Replacement]
    \setlabel {Axiom of Replacement}
    \label {axiom:NBG Axiom of Replacement}
    \[
        \forall x \forall F (\mathbf{isfunc} (F) \implies \exists y (y = F[x]))
    \]
\end{axiom}

\begin{axiom}[Axiom of Union]
    \setlabel {Axiom of Union}
    \label {axiom:NBG Axiom of Union}
    \[
        \forall x \exists y (y = \bigcup x)
    \]
\end{axiom}

\begin{axiom}[Axiom of Power Set]
    \setlabel {Axiom of Power Set}
    \label {axiom:NBG Axiom of Power Set}
    \[
        \forall x \exists y (y = \mathcal{P} (x))
    \]
\end{axiom}

\begin{axiom}[Axiom of Infinity]
    \setlabel {Axiom of Infinity}
    \label {axiom:NBG Axiom of Infinity} (存在归纳集)
    \[
        \exists x (\varnothing \in x \land \forall y (y \in x \implies y \cup \{y\} \in x))
    \]
\end{axiom}

\begin{axiom}[Axiom of Foundation]
    \setlabel {Axiom of Foundation}
    \label {axiom:NBG Axiom of Foundation}
    \[
        \forall x (x \neq \varnothing \implies \exists y (y \in x \land y \cap x = \varnothing))
    \]
\end{axiom}

\begin{axiom}[Axiom of Global Choice]
    \setlabel {Axiom of Global Choice}
    \label {axiom:NBG Axiom of Global Choice}
    \[
        \exists f (\mathbf{isfunc} (f) \land \forall x (x \neq \varnothing \implies \exists y (y \in x \land (x,y) \in f)))
    \]
\end{axiom}

上述 \ref{axiom:NBG Axiom of Global Choice} 有个弱化版本如下:

\begin{axiom}[Axiom of Choice]
    \setlabel {Axiom of Choice}
    \label {axiom:NBG Axiom of Choice}
    \[
        \forall x \exists f (\mathbf{isfunc} (f) \land \forall y ((y \in x \land y \neq \varnothing) \implies \exists z ((y,z) \in f \land z \in y)))
    \]
\end{axiom}

称满足上述定理要求的映射 \(f\) 为 \(x\) 上的选择函数 (choice function).

NBG 公理 \cite{TarasBanakh:ClassicalSetTheory} 由以下 14 条公理组成:

\begin{enumerate}
    \item \ref{axiom:NBG Axiom of Equality}
    \[
        \forall X \forall Y (X = Y \implies \forall Z (X \in Z \iff Y \in Z))
    \]
    \item \ref{axiom:NBG Axiom of Pair}
    \[
        \forall x \forall y \exists z \forall u (u \in z \iff (u = x \lor u = y))
    \]
    \item \ref{axiom:NBG Axiom of Membership}
    \[
        \exists \mathfrak{E} \forall z (z \in \mathfrak{E} \iff \exists x \exists y (z = (x,y) \land x \in y))
    \]
    \item \ref{axiom:NBG Axiom of Domain}
    \[
        \forall X \exists D \forall x (x \in D \iff \exists y ((x,y) \in X))
    \]
    \item \ref{axiom:NBG Axiom of Difference}
    \[
        \forall X \forall Y \exists D \forall x (x \in D \iff (x \in X \land x \notin Y))
    \]
    \item \ref{axiom:NBG Axiom of Product}
    \[
        \forall X \forall Y \exists P \forall z (z \in P \iff \exists x \exists y (z = (x,y) \land x \in X \land y \in Y))
    \]
    \item \ref{axiom:NBG Axiom of Inversion}
    \[
        \forall X \exists I \forall z (z \in I \iff \exists x \exists y (z = (x,y) \land (y,x) \in X))
    \]
    \item \ref{axiom:NBG Axiom of Cycle}
    \[
        \forall X \exists C \forall t (t \in C \iff \exists x \exists y \exists z (t = (z,x,y) \land (x,y,z) \in X))
    \]
    \item \ref{axiom:NBG Axiom of Replacement}
    \[
        \forall x \forall F (\mathbf{isfunc} (F) \implies \exists y (y = F[x]))
    \]
    \item \ref{axiom:NBG Axiom of Union}
    \[
        \forall x \exists y (y = \bigcup x)
    \]
    \item \ref{axiom:NBG Axiom of Power Set}
    \[
        \forall x \exists y (y = \mathcal{P} (x))
    \]
    \item \ref{axiom:NBG Axiom of Infinity}
    \[
        \exists x (\varnothing \in x \land \forall y (y \in x \implies y \cup \{y\} \in x))
    \]
    \item \ref{axiom:NBG Axiom of Foundation}
    \[
        \forall x (x \neq \varnothing \implies \exists y (y \in x \land y \cap x = \varnothing))
    \]
    \item \ref{axiom:NBG Axiom of Global Choice}
    \[
        \exists f (\mathbf{isfunc} (f) \land \forall x (x \neq \varnothing \implies \exists y (y \in x \land (x,y) \in f)))
    \]
\end{enumerate}

我们借由 NBG 公理给出一些推论:

\begin{corollary}
    \label {corollary:no infinite descending chain}
    不存在无限降链 (infinite descending chain) \(x_0 \supset x_1 \supset x_2 \supset \dots\), 且不存在 \(x \in x\).

    \begin{proof}
        由 \ref{axiom:NBG Axiom of Foundation}.
    \end{proof}
\end{corollary}

\begin{corollary}
    \label {corollary:NBG every set can be separated by a class}
    集合的子集是集合, 从而集合 \(x\) 与类 \(C\) 的交 \(x \cap C\) 也是集合.

    这里的做法在于使用 \ref{axiom:NBG Axiom of Power Set} 并且意识到 \(y \subseteq x \implies y \in \mathcal{P} (x)\).
\end{corollary}

\begin{corollary}
    \label {corollary:NBG every property can be written as a class}
    我们说明如何把任何一个性质都写作类, 从而我们可以对一个集合进行分离操作, 也即我们给出类 \(\{x : \phi(x,p_1,p_2 \cdots p_n)\}\).

    \begin{proof}
        我们总是将 \(\forall x\) 认作 \(\neg \exists x\), 我们给出一种归纳方法,
        假定公式中有 \(n\) 个变元, 考察 \(\mathfrak{Un} := \mathfrak{U} \times \mathfrak{U} \times \dots \times \mathfrak{U}\) 上的类,
        并且已经将一部分的命题转为类 \(P\), 命题的否定无非是 \(\mathfrak{Un} \setminus P\), 命题的析取无非是 \(P_1 \cap P_2\),
        命题的合取无非是 \(P_1 \cup P_2\), 两个类属于引导出将 \(\mathfrak{E} \times \mathfrak{U} \times \mathfrak{U} \dots \mathfrak{U}\) 上多次施以
        \ref{axiom:NBG Axiom of Cycle} 与 \ref{axiom:NBG Axiom of Inversion} 的结果, 利用 \ref{axiom:NBG Axiom of Domain} 可以丢弃用完的变量.
        从而我们可以将任何命题转为类, 于是可以有集合 \(\{z \in x : P(z)\}\).
    \end{proof}
\end{corollary}

另外的, 将 NBG 公理中的 \ref{axiom:NBG Axiom of Membership}, \ref{axiom:NBG Axiom of Domain},
\ref{axiom:NBG Axiom of Difference}, \ref{axiom:NBG Axiom of Product}, \ref{axiom:NBG Axiom of Inversion},
\ref{axiom:NBG Axiom of Cycle} 替换为以下公理, 我们得到了 BGC 公理, 其与 NBG 等价:

\begin{axiom}[Axiom of Comprehension]
    \setlabel {Axiom of Comprehension}
    \label {axiom:BG Axiom of Comprehension}
    \[
        \forall X_1 \forall X_2 \dots \forall X_n \exists Y (Y = \{x : \phi (x,X_1,X_2, \dots,X_n)\})
    \]
\end{axiom}

更细致的讨论见本章末尾.

\subsection{基本构造}

\begin{corollary}
    集合的子类是集合.

    \begin{proof}
        对 \(X \subseteq y\) 有 \(X \in \mathcal{P} (y)\).
    \end{proof}
\end{corollary}

\begin{definition}
    \label {definition:union of two sets}
    集合 \(x\) 与 \(y\) 的并定义为 \(x \cup y := \bigcup \{x,y\}\).
\end{definition}

\begin{definition}
    \label {definition:intersection of two sets}
    集合 \(x\) 与 \(y\) 的交 \(x \cap y\) 也是集合.

    \begin{proof}
        根据 \ref{corollary:NBG every set can be separated by a class}.
    \end{proof}
\end{definition}

\begin{definition}
    \label {definition:difference of two sets}
    集合 \(x\) 与 \(y\) 的差集 \(x \setminus y\) 是一个集合.

    \begin{proof}
        对 \(x, \mathfrak{U} \setminus y\) 应用 \ref{corollary:NBG every set can be separated by a class}.
    \end{proof}
\end{definition}

\begin{definition}
    \label {definition:product of two sets}
    集合 \(x\) 与 \(y\) 的积 \(x \times y\) 是一个集合.

    \begin{proof}
        \(x \times y \subseteq \mathcal{P} \mathcal{P} (x \cup y)\), 从而是一个集合.
    \end{proof}
\end{definition}

\begin{definition}
    \label {definition:function from a set to a set}
    集合 \(x\) 到 \(y\) 的全体映射 \(y^x\) 构成一个集合.

    \begin{proof}
        \(f \subseteq x \times y\), 从而是一个集合.
    \end{proof}
\end{definition}

\begin{definition}
    \label {definition:surjective (set)}
    对于 \(x,y\) 与 \(f : x \to y\), \(f\) 是满射 (surjective), 当且仅当 \(f[x] = y\).
\end{definition}

\begin{definition}
    存在类 \(\mathfrak{Rel} := \{r : \mathbf{isbinrel} (r)\}\) 为全体二元关系集构成的类.

    \begin{proof}
        \[
            \mathfrak{Rel} = \mathfrak{U} \setminus \mathbf{dom} ((\mathfrak{E}^{-1} \setminus \mathfrak{U} \times (\mathfrak{U} \times \mathfrak{U})))
        \]
    \end{proof}
\end{definition}

以下证明写起来过于冗长, 读者可自行运用 \ref{theorem:Gödel class existence} 进行验证.

\begin{definition}
    存在类 \(\mathfrak{Func} := \{f : \mathbf{isfunc} (f)\}\) 为全体映射集构成的类.
\end{definition}

\begin{definition}
    对于类 \(A,X\) 亦定义 \(X^A\) 为 \(A\) 到 \(X\) 的全体映射构成的类.
\end{definition}

\begin{definition}
    对一个 \(X \subseteq A \times \mathfrak{U}\), 可以视作一组以 \(A\) 为指标的集合 \({(X_\alpha)}_{\alpha \in A}\).
    定义 \(\bigcup_{\alpha \in A} X_\alpha = \mathbf{ran} (X)\), \(\bigcap_{\alpha \in A} X_\alpha = \mathbf{dom} (X)\).

    也可以视作多值函数 (multifunction) \(X : A \multimap \mathfrak{U}\) 给 \(\alpha \in A\) 值 \(X[\{\alpha\}]\),
    并且对 \(B \subseteq A\) 给出 \(X[B] = \mathbf{ran} (X \cap (B \times \mathfrak{U}))\).
\end{definition}

\begin{definition}[笛卡尔积]
    \label {definition:cartesian product}
    对于类 \(A,X \subseteq A \times \mathfrak{U}\), 定义 \(\prod_{\alpha \in A} X_\alpha := \{f \in \mathfrak{Func} : \forall (\alpha \in A)(f(\alpha) \in X_\alpha) \land (\mathbf{dom} (f) = A)\}\), 称为 \(X = (X_\alpha)_{\alpha \in A}\) 的笛卡尔积 (cartesian product).
\end{definition}

真类 \(A\) 诱导出的笛卡尔积是空类.

\begin{definition}[无交并]
    \label {definition:disjoint union}
    对于类 \(A,X \subseteq A \times \mathfrak{U}\), 定义 \(\coprod_{\alpha \in A} X_\alpha := \{(x,y) \in \mathfrak{U} \times A : x \in X_y\}\), 称为 \(X = (X_\alpha)_{\alpha \in A}\) 的无交并 (disjoint union).
\end{definition}

\subsection{Zermelo-Fraenkel 公理}

与 NBG 公理思路不同的是 ZF 公理, ZF 公理体系没有 NBG 公理中类的概念, 或者说 ZF 公理体系中的类 \(C\) 代
指一个有单个自由变量的命题 \(x \in C := \phi(x, p_1, p_2 \dots)\), 其中 \(p_1, p_2 \dots\) 是给定参数.

相应的, 类的运算被视作逻辑命题的计算.

\begin{definition}
    \label {definition:ZF universe}
    定义 \(\mathfrak{U} := \{x : x = x\}\), 称为宇宙 (universe).
    \label {definition:ZF subclass}
    定义 \(X \subseteq Y := \forall x (x \in X \implies x \in Y)\), 称为 \(X\) 是 \(Y\) 的子类 (subclass).
    \label {definition:ZF class intersection}
    定义 \(\bigcap X := \{x : \forall y \in X (x \in y)\}\), 称为 \(X\) 的交集 (intersection).
    \label {definition:ZF class union}
    定义 \(\bigcup X := \{x : \exists y \in X (x \in y)\}\), 称为 \(X\) 的并集 (union).
    \label {definition:ZF power class}
    定义 \(\mathcal{P} (X) := \{Y : Y \subseteq X\}\), 称为 \(X\) 的幂 (power).
    \label {definition:ZF class difference}
    定义 \(X \setminus Y := \{x : x \in X \land x \notin Y\}\), 称为 \(X\) 与 \(Y\) 的差集 (difference).
\end{definition}

此意义上, 集合自然是类 \(\{x:x \in S\}\), ZF 公理包含 (本节大写字母亦表示集合):

\begin{axiom}[Axiom of Extensionality]
    \setlabel {ZFC Axiom of Extensionality}
    \label {axiom:ZF Axiom of Extensionality}
    \[
        \forall X \forall Y (\forall z (z \in X \iff z \in Y) \implies X = Y)
    \]
\end{axiom}

\begin{axiom}[Axiom of Pair]
    \setlabel {ZFC Axiom of Pair}
    \label {axiom:ZF Axiom of Pair}
    \[
        \forall X \forall Y \exists Z \forall U (U \in Z \iff (U = X \lor U = Y))
    \]
\end{axiom}

\begin{axiom}[Axiom of Union]
    \setlabel {ZFC Axiom of Union}
    \label {axiom:ZF Axiom of Union}
    \[
        \forall X \exists Y \forall z (z \in Y \iff \exists u \in X (z \in u))
    \]
\end{axiom}

\begin{axiom}[Axiom of Power Set]
    \setlabel {ZFC Axiom of Power Set}
    \label {axiom:ZF Axiom of Power Set}
    \[
        \forall X \exists Y \forall z (z \in Y \iff z \subseteq X)
    \]
\end{axiom}

\begin{axiom}[Axiom Schema of Separations]
    \setlabel {ZFC Axiom Schema of Separations}
    \label {axiom:ZF Axiom Schema of Separations}
    \[
        \forall X \exists Y \forall z (z \in Y \iff (z \in X \land \phi (z)))
    \]
\end{axiom}

寻此几条公理, 我们仍然可以仿照 NBG 公理进行一些定义, 不过我们要给一个集合作为基础:

\begin{definition}
    \label {definition:ZF empty set}
    空集 (empty set) 定义为 \(\varnothing := \{x \in X : x \neq x\}\), 此中要求至少存在一个集合.

    \label {definition:ZF ordered pair}
    有序对 (ordered pair) \((x,y)\) 定义为 \(\{\{x\},\{x,y\}\}\).

    \label {definition:ZF ordered triple}
    有序三元对 (ordered triple) \((x,y,z)\) 定义为 \(((x,y),z)\).

    \label {definition:ZF set product}
    集合 \(X\) 与 \(Y\) 的积 (product) 定义为 \(X \times Y := \{(x,y) : x \in X \land y \in Y\}\),
    可以由 \(\mathcal{P} (\mathcal{P} (X \cup Y))\) 上用分离公理给出.

    \label {definition:ZF binary relation}
    \(X\) 上的二元关系 (binary relation) 定义为 \(R \subseteq X \times X\).

    \label {definition:ZF function}
    映射 (function) 定义为一个有序对构成的类 \(f\), 且满足
    \(\forall x \forall y \forall z (((x,y) \in f \land (x,z) \in f) \implies (y = z))\).

    映射自然延拓至类, 定义为满足以上唯一性条件且每个元素都是有序对的类.

    \label {definition:ZF image}
    \(X\) 在 \(f\) 下的像 (image) 定义为 \(f[X] := \{y : \exists x \in X ((x,y) \in f)\}\).
\end{definition}

\begin{axiom}[Axiom of Infinity]
    \setlabel {ZFC Axiom of Infinity}
    \label {axiom:ZF Axiom of Infinity}
    \[
        \exists x (\varnothing \in x \land \forall y (y \in x \implies y \cup \{y\} \in x))
    \]
\end{axiom}

\begin{axiom}[Axiom Schema of Replacement]
    \setlabel {ZFC Axiom Schema of Replacement}
    \label {axiom:ZF Axiom Schema of Replacement}
    \[
        \forall f \forall x (\mathbf{isfunc} (f) \implies \exists y (y = f[x]))
    \]
\end{axiom}

\begin{axiom}[Axiom of Regularity]
    \setlabel {ZFC Axiom of Regularity}
    \label {axiom:ZF Axiom of Regularity}
    \[
        \forall x (x \neq \varnothing \implies \exists y (y \in x \land y \cap x = \varnothing))
    \]
\end{axiom}

ZF 公理 \cite{ThomasJech:SetTheory} 代指以下 8 条公理:

\begin{enumerate}
    \item \ref{axiom:ZF Axiom of Extensionality}
    \[
        \forall X \forall Y (\forall z (z \in X \iff z \in Y) \implies X = Y)
    \]
    \item \ref{axiom:ZF Axiom of Pair}
    \[
        \forall X \forall Y \exists Z \forall U (U \in Z \iff (U = X \lor U = Y))
    \]
    \item \ref{axiom:ZF Axiom of Union}
    \[
        \forall X \exists Y \forall z (z \in Y \iff \exists u \in X (z \in u))
    \]
    \item \ref{axiom:ZF Axiom of Power Set}
    \[
        \forall X \exists Y \forall z (z \in Y \iff z \subseteq X)
    \]
    \item \ref{axiom:ZF Axiom Schema of Separations}
    \[
        \forall X \exists Y \forall z (z \in Y \iff (z \in X \land \phi (z)))
    \]
    \item \ref{axiom:ZF Axiom of Infinity}
    \[
        \exists x (\varnothing \in x \land \forall y (y \in x \implies y \cup \{y\} \in x))
    \]
    \item \ref{axiom:ZF Axiom Schema of Replacement}
    \[
        \forall f \forall x (\mathbf{isfunc} (f) \implies \exists y (y = f[x]))
    \]
    \item \ref{axiom:ZF Axiom of Regularity}
    \[
        \forall x (x \neq \varnothing \implies \exists y (y \in x \land y \cap x = \varnothing))
    \]
\end{enumerate}

囊括以下选择公理的体系称为 ZFC 公理:

\begin{axiom}[Axiom of Choice]
    \setlabel {ZFC Axiom of Choice}
    \label {axiom:ZF Axiom of Choice}
    \[
        \forall x \exists f (\mathbf{isfunc} (f) \land \forall y (y \in x \implies \exists z ((y,z) \in f)))
    \]
\end{axiom}

可以发现, NBG 公理中对类操作的 \ref{axiom:NBG Axiom of Equality}, \ref{axiom:NBG Axiom of Membership},
\ref{axiom:NBG Axiom of Domain}, \ref{axiom:NBG Axiom of Difference}, \ref{axiom:NBG Axiom of Product},
\ref{axiom:NBG Axiom of Inversion}, \ref{axiom:NBG Axiom of Cycle}, 在 ZFC 下体现为类背后的逻辑命题的计算,
而 \ref{axiom:NBG Axiom of Pair}, \ref{axiom:NBG Axiom of Union}, \ref{axiom:NBG Axiom of Power Set},
\ref{axiom:NBG Axiom of Infinity}, \ref{axiom:NBG Axiom of Foundation}, \ref{axiom:NBG Axiom of Choice}
在 ZFC 下体现为集合的操作与要求.

可以证明在只考虑集合的情况下, ZFC 公理与 NBG 公理等价, 我们将选取 NBG 公理, 因为一定程度上 NBG 公理表述更加方便, 严格给出了 "类" 的概念, 而非 ZFC 公理中的一个 "语法糖".

\subsection{序数}

序数几乎是集合论上唯一的结构, 有必要对其进行研究.

\subsubsection{偏序}

\begin{definition}
    一个等价关系 \(\sim\) 是满足自反性 (reflexivity), 对称性 (symmetry), 传递性 (transitivity) 的二元关系.
    \begin{enumerate}
        \item 自反性 (reflexivity): \(x \sim x\).
        \item 对称性 (symmetry): \(x \sim y \implies y \sim x\).
        \item 传递性 (transitivity): \(x \sim y \land y \sim z \implies x \sim z\).
    \end{enumerate}


    等价关系给出了集合的一个划分, 也即对于定义于 \(X\) 上的等价关系 \(R \subseteq X \times X\), \(x \in X\) 的等价类 (equivalence class) 定义为

    \begin{equation}
        [x]_R := \{y \in X : x R y\}
    \end{equation}

    对 \(X\) 给出了拆分 \(A = \{S \in \mathcal{P} X : \exists x (S = [x]_R)\}\),
    而 \(X = \bigcup A\) 且 \(\forall S, T \in A : S \cap T = \varnothing \iff S \neq T\).

    同理, 对于一个划分 \(A\), 我们可以定义相应的等价关系 \(R\) 为 \(x R y \iff \exists S \in A (x \in S \land y \in S)\).
\end{definition}



\begin{definition}
    一个二元关系 \(\le\) 称偏序关系 (partial ordering) 若满足:

    \begin{enumerate}
        \item 自反性 (reflexivity): \(x \le x\).
        \item 反对称性 (antisymmetry): \(x \le y \land y \le x \implies x = y\).
        \item 传递性 (transitivity): \(x \le y \land y \le z \implies x \le z\).
    \end{enumerate}

    在只考虑集合 \(P\) 对情况下, 我们也称 \(\le\) 为 \(P\) 上的偏序, 代指 \((\le) \subseteq P \times P\).

    称 \(P\) 上线序则要求 \(\forall x \forall y (x \le y \lor y \le x)\).

    若偏序由 \(\le\) 给定, 我们也用 \(\ge, <, >\), 其意义是自明的.
\end{definition}

\begin{definition}
    对于偏序集 (partially ordered set) \((P, \le)\), 对于 \(X \subseteq P\) 定义:
    \begin{enumerate}
        \item 极大元 (maximal element): \(x \in X\) 为极大元, 若 \(\forall y \in X (x \le y \implies x = y)\).
        \item 极小元 (minimal element): \(x \in X\) 为极小元, 若 \(\forall y \in X (y \le x \implies x = y)\).
        \item 最大元 (greatest element): \(x \in X\) 为最大元, 若 \(\forall y \in X (y \le x)\).
        \item 最小元 (least element): \(x \in X\) 为最小元, 若 \(\forall y \in X (x \le y)\).
        \item 上界 (upper bound): \(x \in X\) 为上界, 若 \(\forall y \in X (y \le x)\).
        \item 下界 (lower bound): \(x \in X\) 为下界, 若 \(\forall y \in X (x \le y)\).
        \item 上确界 (supremum): \(x \in P\) 为上确界, 若 \(x\) 为上界且对于任意上界 \(y\) 有 \(x \le y\).
        \item 下确界 (infimum): \(x \in P\) 为下确界, 若 \(x\) 为下界且对于任意下界 \(y\) 有 \(y \le x\).
    \end{enumerate}
\end{definition}

\begin{definition}
    若偏序集 \((P, \le)\) 中任意两个元素均有上确界和下确界, 命之为格 (lattice), 格的理论将在后面几章叙述.
\end{definition}

\begin{definition}
    偏序是集合上的结构, 我们研究保持偏序结构的映射, 也即对于偏序集 \((P, \le)\) 和 \((Q, \le)\),
    若单射 \(f : P \to Q\) 满足 \(x \le y \implies f(x) \le f(y)\), 则称 \(f\) 为保序映射 (order-preserving map)
    线序间的保序映射也称增 (increasing).
\end{definition}

\begin{definition}
    对于偏序集 \((P, \le_P)\) 和 \((Q, \le_Q)\), 若存在保序双射 \(f : P \to Q\), 且其逆映射亦保序, 则称同构 (isomorphism), 记作 \(P \cong Q\).
\end{definition}

\subsubsection{良序}

\begin{definition}
    一个线序称为良序 (well-ordering), 若其任意非空类均有最小元.
\end{definition}

\begin{lemma}
    \label{lemma:well-ordering increasing map lemma}
    对于良序集 \((W, \le)\) 以及增映射 \(f : W \to W\), 则 \(\forall x (x \le f(x))\).

    \begin{proof}
        构造 \(W\) 子集 \(S = \{x \in W : x > f(x)\}\), \(S\) 有最小元 \(x\),
        而 \(x > f(x)\) 意味着 \(f(x) > f(f(x))\), 而 \(f(x) < x\) 与 \(x\) 最小矛盾.
    \end{proof}
\end{lemma}

\begin{corollary}
    良序集自同构 (automorphism) 必为恒等映射.
\end{corollary}

\begin{corollary}
    两个良序集间的同构存在则唯一.
\end{corollary}

\begin{definition}
    良序集的前段 (initial segment) 定义为 \(S \subseteq W\) 且 \(x \ge y \implies (x \in S \implies y \in S)\).
\end{definition}

\begin{lemma}
    \label{lemma:well-ordering segment is well-ordering lemma}
    前段是良序集, 序继承自原良序集, 并可写成 \(\{x \in W : x < u\}\) 的形式, 称为 \(u\) 的前段 \(W(u)\).

    \begin{proof}
        对于 \(S\) 子集, 取其在 \(W\) 中最小元 \(x\) 即可. 而 \(S\) 可以被写成 \(W \setminus S\) 最小元的前段.
    \end{proof}
\end{lemma}

\begin{lemma}
    \label{lemma:well-ordering segment unequal lemma}
    真前段必不同构于原良序集.

    \begin{proof}
        同构于前段违反 \ref{lemma:well-ordering increasing map lemma}.
    \end{proof}
\end{lemma}

\begin{theorem}
    \label{theorem:well-ordering segment equal theorem}
    任意两个良序集 \(W, W^\prime\) 一下三者成立其一:
    \begin{enumerate}
        \item \(W \cong W^\prime\).
        \item \(W\) 同构于 \(W^\prime\) 的真前段.
        \item \(W^\prime\) 同构于 \(W\) 的真前段.
    \end{enumerate}

    \begin{proof}
        构造 \(f = \{(x,y) \in W \times W^\prime : W(x) \cong W^\prime(y)\}\),
        根据 \ref{lemma:well-ordering segment unequal lemma} 有 \(\{(x,y) \in f \land (x,z) \in f \implies y = z\}\) 与
        \(\{(y,x) \in f \land (z,x) \in f \implies y=z\}\), 
        故 \(f\) 为 \(\mathbf{dom} (f)\) 与 \(\mathbf{ran} (f)\) 间的双射.

        注意到若 \(\mathbf{dom} (f) \neq W\), 且 \(\mathbf{ran} (f) \neq W^\prime\),
        则取最小元 \(x \in W \setminus \mathbf{dom} (f)\) 与 \(y \in W^\prime \setminus \mathbf{ran} (f)\),
        \(f\) 是 \(W(x)\) 与 \(W^\prime(y)\) 间同构故 \((x,y) \in f\), 与 \(x \in \mathbf{dom} (f)\) 矛盾.

        故 \((\mathbf{dom} (f) = W) \land (\mathbf{ran} (f) = W^\prime)\), \((\mathbf{dom} (f) = W) \land \neg(\mathbf{ran} (f) = W^\prime)\), 
        \(\neg(\mathbf{dom} (f) = W) \land (\mathbf{ran} (f) = W^\prime)\) 三者成立其一, 也即上述命题成立.
    \end{proof}
\end{theorem}

\begin{definition}
    同构的良序集称为有同样的序形 (order type), 序数是表示序形的集合.
\end{definition}

\subsubsection{序数}

\begin{definition}
    一个传递集 (transitive set) 定义为 \(\bigcup x \subseteq x\) 的集合 \(x\), 也即 \(x\) 的元素也都是 \(x\) 的子集, 传递类亦同理.
\end{definition}

\begin{definition}
    \label{definition:ordinal}
    一个序数 (ordinal numbers) 是一个传递的良序集, 偏序 \(<\) 由 \(\in\) 给出.
\end{definition}

我们用 \(\mathbf{On}\) 表示全体序数构成的类.

\begin{lemma}
    \label{lemma:ordinal numbers properties}
    序数满足如下性质:

    \begin{enumerate}
        \item \(\varnothing \in \mathbf{On}\) 
        \item \(\alpha \in \mathbf{On} \land \beta \in \alpha \implies \beta \in \mathbf{On}\)
        \item \(\alpha \in \mathbf{On} \land \beta \in \mathbf{On} \implies (\alpha \subset \beta \implies \alpha \in \beta)\)
        \item \(\alpha \in \mathbf{On} \land \beta \in \mathbf{On} \implies \alpha \subseteq \beta \lor \beta \subseteq \alpha\)
    \end{enumerate}

    \begin{proof}
        第一条是自明的. 第二条源于 \ref{lemma:well-ordering segment is well-ordering lemma} 和
        \(\forall x \in \tau \in \beta \implies x \in \beta\). 第三条可以取 \(\beta \setminus \alpha\) 的最小元 \(\gamma\),
        注意到 \(\gamma \in x \in \alpha \implies \gamma \in \alpha\), 故 \(\alpha = \beta(\gamma) = \gamma\) 而后面一个等号无非源自 \(\gamma \subseteq \beta\) 与 \(\gamma\) 的极小性.
        第四条只需注意到 \(\alpha \cap \beta \notin \alpha \cap \beta\) 即可.
    \end{proof}
\end{lemma}

由 \ref{lemma:ordinal numbers properties} 立得以下推论:

\begin{corollary}
    \label{corollary:ordinal numbers properties}
    首先, 我们将良序推广到类 \(\mathbf{On}\) 上, 也即 \(\alpha \le \beta \iff \alpha \subseteq \beta\),

    \begin{enumerate}
        \item 对于任意序数 \(\alpha\), 有 \(\alpha = \{\beta : \beta < \alpha\}\).
        \item 类 \(C \subseteq \mathbf{On}\), 则有 \(\mathrm{inf} C := \bigcap C\) 为序数.
        \item 集合 \(S \subseteq \mathbf{On}\), 则有 \(\mathrm{sup} S := \bigcup S\) 为序数.
    \end{enumerate}
\end{corollary}

\begin{lemma}
    任何良序集 \(W\) 都同构于某个序数.

    \begin{proof}
        定义类 \(F = \{u : \exists x \exists y(u=(x,y) \land x \in W \land W(x) \cong y \land y \in \mathbf{On})\}\), 
        考察 \(F \upharpoonright W\) 即可, 由 \ref{axiom:NBG Axiom of Replacement} 知 \(\mathbf{ran} (f)\) 是序数.
    \end{proof}
\end{lemma}

\begin{definition}
    对于序数 \(\alpha\), 定义 \(\alpha + 1 := \alpha \cup \{\alpha\}\), 称为 \(\alpha\) 的后继 (successor), 后继也是序数.
\end{definition}

\begin{corollary}
    \label{corollary:ordinal numbers are successors or limits}
    若一个非空序数不是后继, 则其为极限序数 (limit ordinal), 即 \(\alpha = \bigcup \alpha\).

    \begin{proof}
        若否, 有 \(\bigcup \alpha + 1 \in \alpha\) 故 \(\bigcup \alpha \in \bigcup \alpha\).
    \end{proof}
\end{corollary}

有了后继序数, 我们可以着手定义自然数.

\begin{definition}
    \label{definition:natural numbers}
    自然数 (natural numbers) 如此的定义:
    \begin{enumerate}
        \item \(0 := \varnothing\).
        \item \(n + 1 := n \cup \{n\}\).
    \end{enumerate}
\end{definition}

\subsection{归纳}

归纳的思想可以追溯到 Peano 公理.

\begin{example}
    \textbf{Peano 公理:} 自然数满足以下性质:
    \begin{enumerate}
        \item \(0\) 是自然数.
        \item 对于任意自然数 \(n\), 存在唯一自然数 \(n+1\) 使得 \(n+1\) 是 \(n\) 的后继.
        \item \(0\) 不是任何自然数的后继.
        \item 不同自然数的后继不同.
        \item \textbf{数学归纳法:} 若性质 \(P\) 满足 \(P(0) \land \forall n (P(n) \implies P(n+1))\), 则 \(P(n)\) 对于任意自然数 \(n\) 成立. 
    \end{enumerate}
\end{example}

在所述集合论中, 我们想要找到自然数集作为 Peano 公理的对应, 此时我们需要引入 \ref{axiom:NBG Axiom of Infinity}.

\begin{definition}
    \label{definition:omega}
    \(\omega\) 定义为归纳集中的最小元, 对于给定的归纳集 \(X\), 可以给出 \(\omega = \bigcap \{x : x \subseteq X \land \varnothing \in y \land \forall y \in x (y \cup \{y\}) \in x\}\).

    \begin{proof}
        集合的交可以用 \(\setminus, \bigcup\) 表示, 故成为一个集合.

        易证 \(\omega\) 归纳, 任取归纳集 \(Y\), 注意到 \(X \cap Y\) 也是归纳集, 故 \(\omega \subseteq Y\).
    \end{proof}
\end{definition}

\begin{corollary}
    极限序数都是归纳集, 故 \(\omega\) 是最小的极限序数.
\end{corollary}

\begin{theorem}[数学归纳法]
    \label{theorem:mathematical induction}
    称 \(\omega\) 为自然数集, \(\omega\) 中的元素称自然数, 若性质 \(P\) 对 \(0\) 成立, 且若对自然数 \(n\) 成立则对 \(n+1\) 成立, 则对任意自然数 \(n \in \omega\) 成立.
    
    \begin{proof}
        取不是自然数的最小元, 其是后继序数 \(n+1\), 而 \(n\) 是自然数.

        同理, 取不满足 \(P\)的最小元, 其是后继序数 \(n+1\), 而 \(n\) 满足 \(P\).
    \end{proof}
\end{theorem}

\begin{theorem}[超限归纳法]
    \label{theorem:transfinite induction}
    若性质 \(P\) 满足如下性质:
    \begin{enumerate}
        \item \(P(0)\) 成立.
        \item 若 \(\alpha\) 是极限序数 \((\forall \beta < \alpha (P(\beta)) \implies P(\alpha))\).
        \item 若 \(\alpha = \beta + 1\) 是后继序数 \(P(\beta) \implies P(\alpha)\).
    \end{enumerate}

    则对于任意序数 \(\alpha\), \(P(\alpha)\) 总成立.

    \begin{proof}
        若对于序数 \(\gamma\) 不成立, 有最小序数 \(\alpha\) 不成立, 而无论其是否是后继序数都矛盾了.
    \end{proof}
\end{theorem}

依赖于超限归纳法, 我们可以定义序数运算, 运算结果仍是序数.

\begin{definition}
    给定 \(\alpha\), 分别对于空集, 后继序数, 极限序数定义 \(\alpha + 0 := \alpha\), \(\alpha + (\beta + 1) := (\alpha + \beta) + 1\), \(\alpha + \gamma := \bigcup_{\beta < \gamma} (\alpha + \beta)\) 为序数的和.
\end{definition}

\begin{definition}
    给定 \(\alpha\), 分别对于空集, 后继序数, 极限序数定义 \(\alpha \cdot 0 := 0\), \(\alpha \cdot (\beta + 1) := (\alpha \cdot \beta) + \alpha\), \(\alpha \cdot \gamma := \bigcup_{\beta < \gamma} (\alpha \cdot \beta)\) 为序数的积.
\end{definition}

\begin{definition}
    给定 \(\alpha\), 分别对于空集, 后继序数, 极限序数定义 \(\alpha^0 := 1\), \(\alpha^{\beta + 1} := \alpha^\beta \cdot \alpha\), \(\alpha^\gamma := \bigcup_{\beta < \gamma} (\alpha^\beta)\) 为序数的幂.
\end{definition}

\begin{lemma}
    对于序数 \(\alpha, \beta, \gamma\), 有
    \begin{enumerate}
        \item \((\alpha + \beta) + \gamma = \alpha + (\beta + \gamma)\).
        \item \((\alpha \cdot \beta) \cdot \gamma = \alpha \cdot (\beta \cdot \gamma)\).
    \end{enumerate}

    \begin{proof}
        对 \(\gamma\) 进行超限归纳即可.
    \end{proof}
\end{lemma}

\begin{definition}
    对于线序集 \(A, B\), 定义线序集的积 \(A \times B\) 为 \(A \times B\) 上的线序 \((a,b) < (c,d)\) 当且仅当 \(b < d \lor (b = d \land a < c)\).

    定义线序集的和 \(A + B\) 为 \(A \times \{0\} \cup B \times \{1\}\) 上的线序, 其中 \((a,0) < (b,1)\) 对于任意 \(a \in A, b \in B\) 成立.
\end{definition}

\begin{definition}
    对于序数 \(\alpha, \beta\), 序数和同构于线序和 \(\alpha + \beta\), 序数积同构于线序积 \(\alpha \cdot \beta\).

    \begin{proof}
        对 \(\beta\) 归纳.
    \end{proof}
\end{definition}

\begin{lemma}
    加法乘法满足如下性质:

    \begin{enumerate}
        \item \(\beta < \gamma \implies \alpha + \beta < \alpha + \gamma\).
        \item \(\alpha < \beta \implies \exists ! \gamma (\beta = \alpha + \gamma)\).
        \item \(\beta < \gamma \implies \alpha \cdot \beta < \alpha \cdot \gamma\).
        \item \(\alpha > 0 \implies \forall \gamma \exists \beta \exists \rho (\gamma = \beta \cdot \alpha + \rho \land \rho < \alpha)\).
        \item \(\beta < \gamma \land \alpha > 1 \implies \alpha^\beta < \alpha^\gamma\).
    \end{enumerate}

    \begin{proof}
        一三五对 \(\gamma\) 归纳, 二则是 \(\{\chi : \alpha \le \chi < \beta\}\) 上的良序, 唯一性由第一条确保.
        四则取 \(\beta\) 为最大的 \(\alpha \cdot \beta \le \gamma\) 的序数.
    \end{proof}
\end{lemma}

\begin{theorem}
    [Cantor] 任意序数 \(\alpha > 0\) 可以被唯一的写作
    \(\alpha = \omega^{\beta_1} \cdot \gamma_1 + \omega^{\beta_2} \cdot \gamma_2 + \dots + \omega^{\beta_n} \cdot \gamma_n\),
    其中 \(\alpha \ge \beta_1 > \beta_2 > \dots > \beta_n\) 为序数, \(\gamma_1, \gamma_2, \dots, \gamma_n\) 为自然数.

    \begin{proof}
        注意到 \(1 = \omega^0\), 取极大 \(\beta_1\) 使得 \(\omega^{\beta_1} \le \alpha\), 有 \(\alpha = \omega^{\beta_1} \cdot \gamma_1 + \rho\),
        对 \(\rho\) 施以归纳即可, \(n\) 有限基于 \ref{axiom:NBG Axiom of Foundation}.
    \end{proof}
\end{theorem}

\begin{example}
    [Hydra 数] 对于一个有根树, 每次选取一个叶节点 \(p\) 以及一个自然数 \(n\).
    删去 \(p\) 寻求 \(p\) 的父节点, 若其不是根节点, 则将其父节点复制 \(n\) 份,
    连接到 \(p\) 的祖父节点处, 则不论如何操作, 最终都会到达只有根节点的树.

    \begin{proof}
        对每颗树 \(T\), 其根节点连结子树 \(T_1, T_2, \dots, T_n\), 定义 \(f(T) := \omega^{f(T_1)} + \omega^{f(T_2)} + \dots + \omega^{f(T_n)}\),
        则每步操作使 \(f\) 减小, 故有限步内必然到达 \(0\).
    \end{proof}
\end{example}

\begin{definition}
    良基关系是 \(P\) 上一二元关系 \(E (<)\), 使得 \(\forall X ((X \subseteq P \land X \neq \varnothing) \implies \exists a (a \in X \land \forall x \in X (\neg(x E a))))\).
\end{definition}

\begin{example}
    良序 \(<\) 是良基关系.
\end{example}

\begin{theorem}
    对于良基关系 \(E\), 有唯一 \(\rho : P \to \mathbf{On}\), 使得 \(\forall x \in P (\rho(x) = \mathrm{sup} \{\rho(y) + 1 : y E x\})\) (任意非空子集有极小元).

    \begin{proof}
        归纳定义一族集合 \(P_\theta\)

        \begin{enumerate}
            \item \(P_0 := \varnothing\).
            \item \(P_{\theta + 1} := \{x \in P : \forall y (y E x \implies y \in P_\theta)\}\).
            \item \(P_\theta := \bigcup_{\beta < \theta} P_\beta\).
        \end{enumerate}

        若有 \(P_\theta = P_{\theta + 1}\), 此时
        必然有 \(P_\theta = P\), 若否 \(P \setminus P_\theta\) 有极小元 \(x\), 有 \(x \in P_{\theta + 1} \setminus P_{\theta}\), 矛盾.
        定义 \(\rho(x) := \sup \{\alpha : x \notin P_{\alpha}\}\), 上述条件的验证是显然的.

        唯一性只需考虑 \(\{x \in P : \rho_1 (x) \neq \rho_2 (x)\}\) 的极小元即可.
    \end{proof}
\end{theorem}

\begin{definition}
    给出一个良基关系 \(E\), 定义一个元素的秩 (rank) 为 \(\rho(x)\), \(E\) 的高 (height) 为 \(\mathbf{ran} \rho\).
\end{definition}


\subsection{Zorn 引理}

这章我们来重温选择公理.

\begin{lemma}
    \label{lemma:On is not a set}
    \(\mathbf{On}\) 不是集合.

    \begin{proof}
        若是集合, 则 \(\mathbf{On} \in \mathbf{On}\), 矛盾.
    \end{proof}
\end{lemma}

\begin{theorem}
    [Zermelo 良序定理] \label{theorem:well-ordering theorem} \setlabel {Zermelo 良序定理}
    任意集合都能被赋予良序, 此命题与 \ref{axiom:NBG Axiom of Choice} 等价.

    \begin{proof}
        我们证明以下两条等价
        \begin{enumerate}
            \item \(\mathbf{Wo} (x)\) : \(x\) 能被赋予良序.
            \item \(\mathbf{AC} (\mathcal{P} x)\) : \(\mathcal{P} x\) 有选择函数.
        \end{enumerate}

        \(\mathbf{Ac} (\mathcal{P}x) \implies \mathbf{Wo} (x)\) : 对于 \(\mathcal{P} (x)\) 上的选择函数 \(c : \mathcal{P}x \setminus {\varnothing} \to c\),
        根据超限归纳法开始定义 \(F_\alpha : \alpha \to x\) 如下, 若构造止于某一步, 则必然 \(\mathbf{ran} F_\alpha = x\), 若否, 构造必然可一直持续.

        \begin{enumerate}
            \item \(F_0 := \varnothing\).
            \item \(F_{\alpha + 1} := F_\alpha \cup \{(c (\alpha,x \setminus \mathbf{ran} F_\alpha))\}\).
            \item \(F_\alpha := \bigcup_{\beta < \alpha} F_\beta\).
        \end{enumerate}

        给出 \(F : \mathbf{On} \to x\) 的存在性考虑 \ref{axiom:NBG Axiom of Replacement} 和 \(F^{-1}\) 并根据 \ref{lemma:On is not a set} 即可知上述构造只能止于某个序数 \(\alpha\), 此即给出的良序.

        \(\mathbf{Wo} (x) \implies \mathbf{Ac} (\mathcal{P}x)\) : 取选择函数为最小值即可, 同理对于任意集合 \(S\) 可以考察 \(\bigcup S\) 上的良序, 从而构造出 \(S\) 上选择函数.

        等价性只需考虑到 \(x \subseteq \mathcal{P} \bigcup x\).
    \end{proof}
\end{theorem}

\begin{theorem}
    [Zorn 引理] \label{theorem:zorn's lemma} \setlabel {Zorn 引理}
    若 \(P\) 是一个非空偏序集, 且任意非空线序子集都有上界, 则 \(P\) 有极大元.

    \begin{proof}
        给出 \(\mathcal{P}x\) 上选择函数 \(c\) , 同样根据 \ref{axiom:NBG Axiom of Replacement} 和 \ref{lemma:On is not a set} 知其成立.
        详述之, 若 \(P\) 无极大元, 可以归纳的进行构造映射:
        \begin{enumerate}
            \item \(F_0 := \{(\varnothing,c(x))\}\).
            \item \(F_{\alpha + 1} := F_\alpha \cup \{\alpha + 1, c (\{a \in x : a > F_\alpha (\alpha)\})\}\).
            \item \(F_\alpha := (\bigcup_{\beta < \alpha} F_\beta) \cup \{(\alpha, \mathbf{Upperbound} \bigcup_{\beta < \alpha} \mathbf{ran} F_\beta)\}\).
        \end{enumerate}
    \end{proof}

    同样, Zorn 引理与 \ref{axiom:NBG Axiom of Choice} 等价.

    \begin{proof}
        对任意集合 \(x\), 在全体 \((S,c)\), 其中 \(S \subseteq x\), \(c\) 是 \(S\) 上的选择函数,
        定义偏序 \((S_1, c_1) \le (S_2, c_2) \iff S_1 \subseteq S_2 \land c_2 \upharpoonright S_1 = c_1\),
        选取极大元便给出了选择函数.
    \end{proof}
\end{theorem}

\subsection{基数}

\begin{definition}
    两个集合 \(X, Y\) 有等势定义为存在双射 \(f : X \to Y\), 记作 \(\abs{X} = \abs{Y}\).
\end{definition}

等势自然是等价关系, 有限集意味着 \(\abs{X} = \abs{n}\) 为自然数, 可数集意味着 \(\abs{X} = \abs{\omega}\).

\begin{definition}
    基数 (cardinal numbers) 是一类序数, \(\alpha\) 是基数意味着 \(\forall \beta < \alpha (\abs{\beta} \neq \abs{\alpha})\).
\end{definition}

\begin{definition}
    偏序 \(\abs{X} \le \abs{Y}\) 定义为存在单射 \(f : X \to Y\).
\end{definition}

\begin{lemma}
    \(\abs{X} \le \abs{Y} \land \abs{Y} \le \abs{X} \implies \abs{X} = \abs{Y}\).

    \begin{proof}
        单射 \(f : X \to Y\) 与单射 \(g : Y \to X\) 给出层垒结构.

        \begin{enumerate}
            \item \(S_0 := X \setminus \mathbf{ran} (g \circ f)\).
            \item \(S_{n + 1} := g \circ f (S_n)\).
        \end{enumerate}

        给出 \(X\) 到 \(g(Y)\) 的双射 \(h : X \to g(Y)\),
        使得他在 \(S_n\) 上的限制为 \(g \circ f\), 而在其他地方为单位映射即可, 从而给出双射 \(h^{-1} \circ g : Y \to X\).
    \end{proof}
\end{lemma}

\begin{lemma}
    满射 \(f : X \to Y\) 给出 \(\abs{X} \ge \abs{Y}\).

    \begin{proof}
        应用选择公理对每个 \(y \in Y\) 选取 \(f^{-1} (\{y\})\) 的一个元素即可.
    \end{proof}
\end{lemma}

\begin{lemma}
    对于集合 \(X, Y\), 有 \(\abs{X} \le \abs{Y} \lor \abs{Y} \le \abs{X}\).

    \begin{proof}
        运用 \ref{theorem:well-ordering theorem} 即可.
    \end{proof}
\end{lemma}

\begin{corollary}
    任意集合都等势于某个基数, 我们用 \(\abs{X}\) 表示 \(X\) 的基数.
\end{corollary}

\begin{theorem}
    [Cantor] \label{theorem:Cantor's Px > x} \(\abs{\mathcal{P} x} > \abs{x}\).

    \begin{proof}
        任意 \(f : x \to \mathcal{P} x\) 非满, 因为 \(\{e \in x : e \notin f(e)\}\) 不在其值域中.
    \end{proof}
\end{theorem}

定义基数的运算如下:

\begin{definition}
    \begin{enumerate}
        \item \(\abs{X} + \abs{Y} := \abs{X \times \{0\} \cup Y \times \{1\}}\).
        \item \(\abs{X} \cdot \abs{Y} := \abs{X \times Y}\).
        \item \(\abs{X}^\abs{Y} := \abs{X^Y}\).
    \end{enumerate}
\end{definition}


\begin{definition}
    \label{definition:aleph}
    归纳的定义基数 \(\aleph\):
    \begin{enumerate}
        \item \(\aleph_0 := \omega\).
        \item \(\aleph_{\alpha + 1}\) 为大于 \(\aleph_\alpha\) 的最小基数.
        \item \(\aleph_\alpha := \bigcup_{\beta < \alpha} \aleph_\beta\).
    \end{enumerate}

    \begin{proof}
        只需证明极限情形, 若有更小等势序数 \(\kappa\), 则必然有 \(\kappa \in \aleph_\beta < \aleph_{\beta + 1} \le \aleph_{\alpha}\), 矛盾.
    \end{proof}
\end{definition}

\begin{hypothesis}
    连续统假设 (continuum hypothesis) 指出 \(\aleph_{\alpha + 1} = 2^{\aleph_\alpha}\),
    它是独立于 ZFC 的.
\end{hypothesis}

现在我们证明有关基数运算的结论.

\begin{theorem}
    \label{theorem:cardinal multiplication}
    \(\forall \alpha (\aleph_\alpha \cdot \aleph_\alpha = \aleph_\alpha)\).

    \begin{proof}
        对 \(\alpha\) 归纳, 假定 \(\forall \beta < \alpha (\aleph_\beta \cdot \aleph_\beta = \aleph_\beta)\),
        我们给出 \(\aleph_\alpha \times \aleph_\alpha\) 上的良序, \((a,b) < (c,d)\) 当且仅当以下三条成立其一:

        \begin{enumerate}
            \item \(\mathbf{max} (a,b) < \mathbf{max} (c,d)\).
            \item \(\mathbf{max} (a,b) = \mathbf{max} (c,d) \land a < c\).
            \item \(\mathbf{max} (a,b) = \mathbf{max} (c,d) \land a = c \land b < d\).
        \end{enumerate}

        此良序同构于一序数 \(\kappa \ge \aleph_{\alpha + 1}\), 故有真前段 \(\gamma = \aleph_{\alpha}\), 其必然在 \(\sigma \times \sigma\) 中,
        而 \(\sigma < \aleph_\alpha\) 故 \(\abs{\gamma} < \abs{\sigma}^2 = \abs{\sigma}\), 矛盾.
    \end{proof}
\end{theorem}

\begin{corollary}
    若 \(\alpha, \beta\) 为基数且至少其一无穷, 则 \(\alpha + \beta = \max \{\alpha, \beta\}\).

    若 \(\alpha, \beta\) 为基数且 \(2 \le \alpha \le \beta\), 则 \(\alpha^\beta = 2^\beta\).

    \begin{proof}
        只需注意到 \(\alpha + \beta \le 2 \cdot \mathbf{max} (\alpha, \beta) \le \mathbf{\alpha, \beta}^2 = \mathbf{max} (\alpha, \beta)\).

        只需注意到 \(\alpha^\beta \le {(2^\beta)}^\beta = 2^{\beta \cdot \beta} = 2^\beta\).
    \end{proof}
\end{corollary}

\subsection{Grothendieck 宇宙}

\begin{definition}
    Grothendieck 宇宙 (Grothendieck universe) 是一个集合 \(\mathcal{U}\), 满足
    \begin{enumerate}
        \item \(\forall u (u \in \mathcal{U} \implies u \subseteq \mathcal{U})\).
        \item \(\forall u \forall v (u, v \in \mathcal{U} \implies \{u,v\} \in \mathcal{U})\).
        \item \(\forall u (u \in \mathcal{U} \implies \mathcal{P} u \in \mathcal{U})\).
        \item 给出映射 \(F\), \(\forall I (I \in \mathcal{U} \land \forall i \in I (F(i) \in \mathcal{U}) \implies \bigcup_{i \in I} F(i) \in \mathcal{U})\).
        \item \(\omega \in \mathcal{U}\).
    \end{enumerate}
\end{definition}

给定一个 Grothendieck 宇宙, 考察它的元素, 相当于给定了一个足够自由的空间, 从而避免一些类的操作.

\begin{hypothesis}
    [Grothendieck] \label{hypothesis:Grothendieck universe}
    对于任意集合, 存在一个 Grothendieck 宇宙包含它.
\end{hypothesis}

接下来我们给出 Grothendieck 宇宙的构造, 先讨论集合的层垒谱系 (Cumulative hierarchy).

\begin{definition}
    归纳定义集合 \(V_\alpha\):

    \begin{enumerate}
        \item \(V_0 := \varnothing\).
        \item \(V_{\alpha + 1} := \mathcal{P} V_\alpha\).
        \item \(V_\alpha := \bigcup_{\beta < \alpha} V_\beta\).
    \end{enumerate}

    满足 \(V_\alpha\) 传递且 \(\alpha < \beta \implies V_\alpha \subset V_\beta\).
\end{definition}

我们希望证明每个集合都在层垒谱系中, 为此需要用到以下引理.

\begin{lemma}
    对于任何集合 \(S\) 有传递集 \(T\) 且 \(S \subseteq T\).

    \begin{proof}
        定义 \(S_0 := S\), \(S_{n + 1} := \mathcal{P} S_n\), \(T := \bigcup_{n \in \omega} S_n\).

        该集合记作 \(\mathbf{TC}(S)\), 称为 \(S\) 的传递闭包.
    \end{proof}
\end{lemma}

\begin{lemma}
    \label {lemma:every set is in V_alpha}
    任意集合均在层垒谱系中.

    \begin{proof}
        对于集合 \(S\), \(\mathbf{TC}(S)\) 对于 \(\in\) 构成良基集, 我们证明其高 \(h\) 满足 \(S \in V_{h + 1}\).
        只需归纳的证明每个 \(x \in \mathbf{TC}(S)\) 均有 \(x \in V_{\rho (x)}\) 即可, 其中 \(\rho\) 为良基关系的秩函数.
    \end{proof}
\end{lemma}

\begin{lemma}
    任何类 \(C\) 都有 \(\in\) 极小元.

    取任意 \(S \in C\), \(\mathbf{TC}(S)\) 传递集, 取集合 \(\mathbf{TC}(S) \cap C\) 之极小者即可.
\end{lemma}

关于层垒谱系可以另做证明, 考察不在层垒谱系中的集合构成的类的 \(\in\) 极小元, 从而得到矛盾.

\begin{theorem}[\(\in\) 归纳]
    \label {theorem:in's induction}
    给定类 \(C\), 若对于任意 \(x \in C\), \(\forall y \in x (y \in C)\), 则 \(C = \mathfrak{U}\).

    \begin{proof}
        取 \(\mathfrak{U} \setminus C\) 的 \(\in\) 极小元 \(x\), 有 \(\forall y \in x (y \in C)\), 矛盾.
    \end{proof}
\end{theorem}

\begin{definition}
    \label {definition:cofinal set}
    一个共尾集 (cofinal set) \(S\) 定义于一个所有有限子集都有上界的拟序集 (有向集) \(P\) 上, 拟序集 (quasi order) 是没有反对称性的偏序集.
    共尾集是满足 \(\forall x \in P (\exists y \in S (x \le y))\) 的 \(P\) 子集.
\end{definition}

\begin{definition}
    \label {definition:confinal type}
    一个共尾集 \(S\) 的共尾类 (cofinal type) 定义为共尾集势的最小值, 记作 \(\mathbf{cf} (S)\).
\end{definition}

\begin{lemma}
    对序数 \(\alpha\) 有增 \(\phi : \mathbf{cf} (\alpha) \to \alpha\), 使得 \(\phi[\mathbf{cf} (\alpha)]\) 是共尾集.

    \begin{proof}
        考察一个长为 \(\mathbf{cf} (\alpha)\) 的共尾集 \(a_\beta\), 考察其增子列
        \(a_\beta : \forall \gamma < \beta (a_\gamma < a_\beta)\), 也是一共尾集,
        该子列前段必然对应 \(\mathbf{cf} (\alpha)\) 前段, 故其序型必为 \(\mathbf{cf} (\alpha)\).
    \end{proof}
\end{lemma}

\begin{definition}
    \label {definition:regular cardinal}
    一个无穷基数 \(\kappa\) 是正则的 (regular) 当且仅当 \(\kappa = \mathbf{cf} (\kappa)\).
\end{definition}

正则基数是一类通过短于该基数的极限到达不了的基数.

\begin{example}
    \(\aleph_{\gamma + \omega}\) 非正则.

    \begin{proof}
        依定义知 \(\aleph_{\gamma + \omega} = \bigcup_{\beta < \omega} \aleph_{\gamma + \beta}\), 故 \(\mathbf{cf} (\aleph_{\gamma + \omega}) \le \omega\).
    \end{proof}
\end{example}

\begin{example}
    \(\aleph_{\gamma + 1}\) 正则.

    \begin{proof}
        假定有长度小于等于 \(\aleph_{\gamma}\) 的共尾集 \(S\), 有
        \(\aleph_{\gamma + 1} = \abs{\bigcup_{\beta < \aleph_\gamma} a_\beta} \le \aleph_\gamma \times \aleph \gamma = \aleph_\gamma\),
        矛盾.
    \end{proof}
\end{example}

\begin{corollary}
    序数的共尾类均为 \(1\) 或正则基数.
\end{corollary}

\begin{definition}
    \label {definition:inaccessible cardinal}
    一个不可数基数 \(\kappa\) 是不可达的 (inaccessible cardinal) 当且仅当 \(\kappa\) 是正则的且 \(\forall \alpha < \kappa (2^\alpha < \kappa)\).
\end{definition}

在 NBG 公理中, 无法证明不可达基数的存在性, Grothendieck 的 \ref{hypothesis:Grothendieck universe} 依旧是一个奢侈的假设.

\begin{theorem}
    Grothendieck 宇宙是层垒谱系中不可达基数 \(\kappa\) 对应的 \(V_\kappa\).

    \begin{proof}
        考察 Grothendieck 宇宙中 \(\mathbf{On}\).
    \end{proof}
\end{theorem}

Grothendieck 宇宙 \(U\) 就像一个虚拟机, 在集合论框架下虚拟的运行了一个集合论, 对应的类便是 \(\mathcal{P} U\) 中的元素, 集合就是 \(U\) 中的元素,
运用 Grothendieck 宇宙可以有效避免一些集合论的困难, 但是其究竟是否有必要, 仍然是数学哲学与群体心理学的交界的议题.

\begin{definition}[von Neumann 宇宙]
    \label {definition:von Neumann universe}
    von Neumann 宇宙 (von Neumann universe) 定义为 \(\bigcup_{\alpha \in \mathbf{On}} V_\alpha\).
\end{definition}

\begin{theorem}
    \ref{axiom:NBG Axiom of Foundation} 和 \(\mathfrak{U} = \mathfrak{V}\) 等价.

    \begin{proof}
        一个方向运用 \ref{lemma:every set is in V_alpha} 即可.

        若 \(\mathfrak{U} = \mathfrak{V}\), 注意到 \(\mathfrak{E} = \mathfrak{E} \upharpoonright \mathfrak{V}\) 良基.
    \end{proof}
\end{theorem}

\subsection{Gödel 编码, 构造性}

\subsubsection{基类, 公式}

\begin{definition}
    基类 (basic class) 是一类能通过 \(\mathfrak{E}\) 经有限长的公式构造出的类.
\end{definition}

\begin{definition}
    我们构造如下基类:
    \begin{enumerate}
        \item \label {definition:NBG basic class of universe}
                宇宙 \(\mathfrak{U} := \mathbf{dom} (\mathfrak{E})\) 是基类.
        \item \label {definition:NBG basic class of subset}
                子集判定 \(\mathfrak{S} = \{(x,y) : x \subseteq y\}\) 是基类.

                \begin{proof}
                    \[
                        \mathfrak{S} = (\mathfrak{U} \times \mathfrak{U}) \setminus (\mathbf{dom} ({(\mathfrak{E}^{-1} \times \mathfrak{U})}^{\circlearrowright} \setminus {(\mathfrak{E} \times \mathfrak{U})}^{\circlearrowleft}))
                    \]
                \end{proof}
        \item \label {definition:NBG basic class of id function}
                单位映射 \(\mathfrak{I} = \{(x,x) : x \in \mathfrak{U}\}\) 是基类.

                \begin{proof}
                    \[
                        \mathfrak{I} = \mathfrak{S}^{-1} \cap \mathfrak{S}
                    \]
                \end{proof}
        \item \label {definition:NBG basic class of domain}
                求定义域 \(\mathfrak{D} = \{(x,y) : \forall t (t \in y \iff \exists z ((t,z) \in x))\}\) 是基类.

                \begin{proof}
                    \[
                        \mathfrak{D} = {(\mathfrak{I} \times \mathfrak{U})}^{\circlearrowleft}
                    \]
                \end{proof}
        \item \label {definition:NBG basic class of range}
                求值域 \(\mathfrak{R} = \{(x,y) : \forall t (t \in y \iff \exists z ((z,t) \in x))\}\) 是基类.

                \begin{proof}
                    \[
                        \mathfrak{R} = {(\mathfrak{I} \times \mathfrak{U})}^{\circlearrowright}
                    \]
                \end{proof}
    \end{enumerate}
\end{definition}

\begin{lemma}
    \label {definition:NBG class of FRG}
    给出二元关系 \(R\), 映射 \(F, G\), 有类 \(F_R G := \{x \in \mathbf{dom}[F] \cap \mathbf{dom}[G] : (F(x),G(x)) \in R\}\).

    \begin{proof}
        \[
            F_R G = \mathbf{dom} ((R \circ F) \cap G)
        \]
    \end{proof}
\end{lemma}

\subsubsection{Gödel 类存在定理}

\begin{definition}[Lévy 层级]
    \label {definition:Lévy hierarchy}
    一个逻辑公式 \(\phi\) 量词有界 (bounded quantifier) 当且仅当其量词均为 \(\forall X \in Y\) 或 \(\exists X \in Y\).

    一个量词有界公式的 Lévy 层级 (Lévy hierarchy) 定义为 \(\Sigma_0 = \Pi_0 = \Delta_0\), 归纳定义高层级的 Lévy 层级.

    \begin{enumerate}
        \item \(\Sigma_{n + 1}\) 公式是形如 \(\exists X_1 \exists X_2 \dots \exists X_m \phi\), 其中 \(\phi\) 是 \(\Pi_n\) 公式.
        \item \(\Pi_{n + 1}\) 公式是形如 \(\forall X_1 \forall X_2 \dots \forall X_m \phi\), 其中 \(\phi\) 是 \(\Sigma_n\) 公式.
        \item \(\Delta_{n}\) 是一类即是 \(\Sigma_n\) 又是 \(\Pi_n\) 的公式.
    \end{enumerate}
\end{definition}

\begin{example}
    任何 \(\Delta_0\) 公式都等价于一个 \(\mathfrak{U}\) 有界公式, 且任何 \(\mathfrak{U}\) 有界公式都等价于一个 \(\Sigma_2\) 公式.

    \begin{proof}
        \(\forall X \in Y (\phi)\) 等价于 \(\forall X \in \mathfrak{U} ((X \in Y) \land \phi)\).
    \end{proof}
\end{example}

\begin{definition}
    一个公式称 \(\mathfrak{U}\) 有界当且仅当量词均为 \(\exists x \in \mathfrak{U}\) 或 \(\forall x \in \mathfrak{U}\).
\end{definition}

\begin{definition}
    \label {definition:n element tuple}
    归纳定义 \(n\) 元组 \((x_1, x_2, \dots, x_n) := ((x_1, x_2, \dots, x_{n-1}),x_n)\)

    \label {definition:nth product of a set}
    归纳定义 \(X^n\) 为 \(n\) 元组的集合, \(X^0 := \{\varnothing\}\), \(X^{n + 1} := X^n \times X\), 当 \(X\) 是集合时 \(X^n\) 也是集合.
\end{definition}

\begin{lemma}
    对于任意自然数 \(i,j \le n\), 有基类 \(\{(x_1, x_2, \dots ,x_n) : x_i \in x_j\}\).

    \begin{proof}
        递归的定义记号 \(\mathbf{dom}^0 := \mathfrak{I}\), \(\mathbf{dom}^{n+1} := \mathbf{dom} \circ \mathbf{dom}^n\),
        根据 \ref{definition:NBG basic class of domain}, \ref{definition:NBG basic class of range} 和 \ref{definition:NBG basic class of id function} 知每个 \(\mathbf{dom}^n\) 为基类.

        于是映射 \(\mathbf{Pr}_{i}^{n} :(x_1, x_2, \dots, x_n) \mapsto x_i\) 为基类 \(\mathbf{ran} (\mathbf{dom}^{n-i})\).

        于是考察 \ref{definition:NBG class of FRG} 中的 \({(\mathbf{Pr}_{i}^{n})}_{\mathfrak{E}} (\mathbf{Pr}_{j}^{n})\) 为基类 \(\{(x_1, x_2, \dots ,x_n) : x_i \in x_j\}\).
    \end{proof}
\end{lemma}

\begin{lemma}
    对于任意自然数 \(i \le n\), (基) 类 \(Y\), 有 (基) 类 \(\{(x_1, x_2, \dots ,x_n) : x_i \in Y\}\) 和基类 \(\{(x_1, x_2, \dots ,x_n) : Y \in x_i\}\).

    \begin{proof}
        \(\{(x_1, x_2, \dots ,x_n) : x_i \in Y\} = \mathbf{dom} ((\mathfrak{U}^n \times Y) \cap \mathbf{Pr}_{i}^{n})\).

        而所有包含 \(Y\) 的集合可以表做类 \(\{(x_1, x_2, \dots ,x_n) : Y \in x_i\} = \mathbf{ran} (\mathfrak{E} \cap (Y \times \mathfrak{U}))\).
    \end{proof}
\end{lemma}

\begin{lemma}
    对于任意自然数 \(n\), (基) 类 \(Y,Z\), 有 (基) 类 \(\{(x_1, x_2, \dots ,x_n) : Y \in Z\}\).

    \begin{proof}
        无非是 \(\varnothing\) 或者 \(\mathfrak{U}^n\).
    \end{proof}
\end{lemma}

以下命题是本节最重要的 Gödel 类存在定理.

\begin{theorem}[Gödel, 1940]
    \setlabel {Gödel 类存在定理}
    \label {theorem:Gödel class existence}
    对任意逻辑公式 \(\phi(x_1, x_2, \dots, x_n, Y_1, Y_2, \dots, Y_m)\), 其中 \(x_1, x_2, \dots, x_n\) 为自由变元,
    而 \(Y_1, Y_2, \dots, Y_m\) 为给定的变元, 存在 \(\mathfrak{U}^n\) 子类 \(\mathbf{Free} (\phi) := \{(x_1, x_2, \dots, x_n) : \phi(x_1, x_2, \dots, x_n, Y_1, Y_2, \dots, Y_m)\}\),
    
    如果 \(Y_1, Y_2, \dots, Y_m\) 是基类 \(\mathbf{Free} (\phi)\) 也是基类.

    \begin{proof}
        每个极小的公式都由两个变元, 一个关系与两个括号表达, 对公式长度施以归纳, 对于公式 \(\phi\).

        \begin{enumerate}
            \item \(\phi = \psi \lor \chi\) 有 
            \[
                \mathbf{Free} (\phi) = \mathbf{Free} (\psi) \cup \mathbf{Free} (\chi)
            \]
            \item \(\phi = \exists X (\psi)\) 依归纳假设有
            \[
                \mathbf{Free} (\psi) = \{(x_1, x_2, \dots, x_n, x) : \psi(x_1, x_2, \dots, x_n, x, Y_1, Y_2, \dots, Y_m)\}
            \]
            从而 \(\mathbf{Free} (\phi) = \mathbf{dom} (\mathbf{Free} (\psi))\).
            \item \(\phi = \neg \psi\) 有
            \[
                \mathbf{Free} (\phi) = \mathfrak{U}^n \setminus \mathbf{Free} (\psi)
            \]
        \end{enumerate}
    \end{proof}
\end{theorem}

\begin{lemma}
    以下定义的公式 \(\phi (X, E)\) 使得满足 \(\phi (X, \mathfrak{E})\) 的类 \(X\) 均非基类.

    \begin{proof}
        仿照 Russell 悖论.

        令 \(2^{< \omega} := \bigcup_{n \in \omega} 2^n\) (\(n\) 到 \(2\) 的映射), 对 \(k \in 2\) 给出映射 \(\vec{k} : 2^{< \omega} \to 2^{< \omega}\),
        使得 \(\vec{k}(s) = {(0,k)} \cup \{(n \cup \{n\}, y) : (n,y) \in s\}\).

        对自然数 \(n\), 同理令 \(2^{<n} := \bigcup_{k < n} 2^k\), 令 \(T := \bigcup_{n \in \omega} 6^{2^{<n}}\).

        对类 \(X\) 定义像 \(X_a := \{x \in \mathfrak{U} : (a,x) \in X\}\), 给出性质 \(X_0 = \mathfrak{E}\) 与 \(\forall n \in \omega \forall \lambda \in 6^{2^{<n}}\):

        \begin{enumerate}
            \item 若 \(\lambda (\varnothing) = 0\) 则 \(X_\lambda = X_{\lambda \circ \vec{0}}\).
            \item 若 \(\lambda (\varnothing) = 1\) 则 \(X_\lambda = (X_{\lambda \circ \vec{0}}) \setminus (X_{\lambda \circ \vec{1}})\).
            \item 若 \(\lambda (\varnothing) = 2\) 则 \(X_\lambda = (X_{\lambda \circ \vec{0}}) \times (X_{\lambda \circ \vec{1}})\).
            \item 若 \(\lambda (\varnothing) = 3\) 则 \(X_\lambda = {(X_{\lambda \circ \vec{0}})}^{-1}\).
            \item 若 \(\lambda (\varnothing) = 4\) 则 \(X_\lambda = {(X_{\lambda \circ \vec{0}})}^{\circlearrowright}\).
            \item 若 \(\lambda (\varnothing) = 5\) 则 \(X_\lambda = \mathbf{dom} (X_{\lambda \circ \vec{0}})\).
        \end{enumerate}

        假定有这样的类 \(X\), 令 \(\Lambda := \{\lambda \in T:\lambda \notin X_{\lambda}\}\) 而任意基类有 \(D = X_\lambda\).
    \end{proof}
\end{lemma}

另外的, 我们有以下结论 \cite[\href{https://stacks.math.columbia.edu/tag/000G}{Tag 000G}]{stacks-project}:

\begin{theorem}[Reflection principle]
    \label {theorem:reflection principle}
    对所有变元都是集合的公式 \(\phi\) 定义 \(\phi^M\) 为将所有 \(\exists x\) 替换为 \(\exists x \in M\), 将所有 \(\forall x\) 替换为 \(\forall x \in M\) 所得的新公式.

    给出集合 \(M_0\) 和有限个公式 \(\phi(x_1, x_2, \dots, x_n)\), 有包含 \(M_0\) 的集合 \(M\) 满足对于任意 \((x_1, x_2, \dots, x_n) \in M^n\) 有 
    \(\phi^M(x_1, x_2, \dots, x_n) \iff \phi(x_1, x_2, \dots, x_n)\) 成立.

    更一般的 \(M\) 可取为归纳集, 乃至层垒谱系中的一员, 允许选择公理时, 有基数不等式 \(\abs{M} \le \abs{M_0} \cdot \aleph_0\).
\end{theorem}

证明以及更深入的理论将在模型论里细讲.

\subsubsection{Gödel 编码}

\begin{definition}
    Gödel 操作 (Gödel operations) 定义为以下九个映射:
    \begin{enumerate}
        \item \(\ddot{G_0} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x\).
        \item \(\ddot{G_1} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x \setminus y\).
        \item \(\ddot{G_2} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x \times y\).
        \item \(\ddot{G_3} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x^{-1}\).
        \item \(\ddot{G_4} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x^{\circlearrowright}\).
        \item \(\ddot{G_5} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto x \cap \mathfrak{E}\).
        \item \(\ddot{G_6} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto \mathbf{dom} (x)\).
        \item \(\ddot{G_7} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto \bigcup x\).
        \item \(\ddot{G_8} : \mathfrak{U} \times \mathfrak{U} \to \mathfrak{U}\), \((x,y) \mapsto \{x,y\}\).
    \end{enumerate}
\end{definition}

\begin{lemma}
    以上九个映射均为基类.

    \begin{proof}
        运用 \ref{theorem:Gödel class existence} 即可.
    \end{proof}
\end{lemma}

\begin{definition}
    定义 \(\dot G_i : \mathfrak{U} \to \mathfrak{U}\), \(\dot G_i (x) := \ddot{G_i} (x,x)\).
\end{definition}

\begin{definition}[Gödel 扩张]
    一个 Gödel 扩张 (Gödel extension) 是映射 \(G : \mathfrak{U} \to \mathfrak{U}\), 使得
    \[
        G(x) = \bigcup_{i = 0}^8 \ddot{G_i} [x \times x] = \{u,u \setminus v,u \times v, u^{-1}, u^{\circlearrowright}, u \cap \mathfrak{E}, \mathbf{dom}(u), \bigcup{u}, \{u,v\} : u,v \in x\}
    \]
\end{definition}

\begin{lemma}
    Gödel 扩张是基类.
\end{lemma}

\begin{lemma}
    对 \(x \subseteq y\), 有 \(G(x) \subseteq G(y)\).
\end{lemma}

\begin{lemma}
    有 \(x \subseteq G(x)\), 给出链 \(x \subseteq G(x) \subseteq G(G(x)) \subseteq \dots\).

    归纳的定义 \(G^{\circ 0}(x) = x\), \(G^{\circ n} (x) := G(G^{\circ (n-1)}(x))\), 定义 Gödel 包 (Gödel's hull) 为
    \(G^{\circ \omega}(x) := \bigcup_{n \in \omega} G^{\circ n}(x)\).
\end{lemma}

\begin{lemma}
    传递集的 Gödel 包依旧传递.

    \begin{proof}
        对传递集 \(x\), \(G(x)\) 亦传递.
    \end{proof}
\end{lemma}

\begin{definition}[Gödel 可构造宇宙]
    \label {definition:Gödel's constructible universe}
    归纳的定义 \((L_\alpha)_{\alpha \in \mathbf{On}}\):

    \[
        L_\alpha := \bigcup_{\beta \in \alpha} (\mathcal{P}(L_\beta)) \cap G^{\circ \omega}(L_\beta \cup \{L_\beta\})
    \]

    定义 Gödel 可构造宇宙 (Gödel's constructible universe) 为
    \[
        \mathfrak{L} := \bigcup_{\alpha \in \mathbf{On}} L_\alpha
    \]
\end{definition}

\begin{lemma}
    \(L_\alpha\) 满足以下性质:
    \begin{enumerate}
        \item \(L_\alpha\) 是传递的.
        \item \(L_{\alpha + 1} = \mathcal{P}(L_\alpha) \cap G^{\circ \omega} (L_\alpha \cup \{L_\alpha\})\).
        \item \(L_\alpha \subseteq V_\alpha\).
        \item \(\alpha \in L_{\alpha + 1}\).
    \end{enumerate}

    \begin{proof}
        第一条只需对 \(\alpha\) 归纳.

        第二条注意到 \(L_{\alpha + 1} = L_\alpha \cup (\mathcal{P} L_\alpha \cap G^{\circ \omega} (L_\alpha \cup \{L_\alpha\})) = \mathcal{P}(L_\alpha) \cap G^{\circ \omega} (L_\alpha \cup \{L_\alpha\})\).

        第三条对 \(\alpha\) 归纳, 注意到 \(\mathcal{P}\) 的限制刚好对应层垒谱系.

        第四条对 \(\alpha\) 归纳, 如若 \(\alpha = \beta + 1\), 有 \(\beta \in L_\alpha\), 自然推出
        以及 \(L_\alpha\) 传递得到 \(\alpha \in \mathcal{P} L_\alpha\), 另一方面 \(\alpha \in G^{\circ \omega} (L_\alpha \cup \{L_\alpha\})\) 源自
        \(\alpha + 1 = \bigcup \{\alpha, \{\alpha, \alpha\}\}\).
        如若 \(\alpha = \bigcup_{\beta < \alpha} \beta\), 所有序数 \(\beta < \alpha\) 有 \(\beta \in L_{\beta + 1} \in L_\alpha\),
        从而 \(\alpha \in \mathcal{P} L_\alpha\), 另一方面 \(\alpha \in G^{\circ \omega} (L_\alpha \cup \{L_\alpha\})\) 是注意到 \(L_\alpha \cap \mathbf{On}\) 可被构造.
    \end{proof}
\end{lemma}

\begin{lemma}
    令 \(x,y \in L_\alpha\), 有 \(x \setminus y\), \(x \cap \mathfrak{E}\), 
    \(\bigcup x\), \(\mathbf{dom} (x)\), \(x \times y\), \(x^{-1}\), \(x^{\circlearrowright}\), \(\{x,y\}\) 均在 \(L_{\alpha + 2}\) 中.
\end{lemma}

\begin{definition}
    一个类 \(X\) 称 Gödel 闭的 (Gödel closed) 当且仅当对于任意 \(i\), \(x,y \in X\) 则 \(\ddot{G_i} (x,y) \in X\).
\end{definition}

\begin{theorem}
    可构造宇宙 \(\mathfrak{L}\) 是 Gödel 闭, 传递的真类, 有 \(\mathbf{On} \subseteq \mathfrak{L} \subseteq \mathfrak{V}\).
\end{theorem}

\begin{remark}
    \(\mathfrak{L}\) 元素可以被解释为一颗取值 \(9\) 高 \(n\) 的满二叉树, 如 \(x \cup y = \ddot{G_7} (\ddot{G_8} (x,y), \ddot{G_i} (a,b))\) 可以被解释为高 \(2\) 的二叉树:

    \begin{center}
        \begin{tikzpicture}
            \node {\(\ddot{G_7}\)} [sibling distance = 3cm]
                child {node {\(\ddot{G_8}\)} [sibling distance = 2cm]
                    child {node {x}}
                    child {node {y}}}
                child {node {\(\ddot{G_i}\)} [sibling distance = 2cm]
                    child {node {a}}
                    child {node {b}}};
        \end{tikzpicture}
    \end{center}

    也即通过 \(\bigcup_{n \in \omega} 9^{2^{< n}}\) 枚举如下.
\end{remark}

定义 \(\vec{k} := 2^{< \omega} \to 2^{< \omega}\) 为 \(\vec{k} (s) = {(0,k)} \cup \{(n \cup \{n\}, y) : (n,y) \in s\}\), 

对 \(\lambda \in 2^{< (n+1)} \to 9\) 给出了两个 \(2^{< n} \to 9\) 的子树 \(\lambda \circ \vec{0}\), \(\lambda \circ \vec{1}\) 于是归纳定义公式:

\begin{definition}
    对于 \(\lambda : 2^{< n} \to 9\), 归纳定义 \(G_\lambda : \mathfrak{U}^{2^n} \to \mathfrak{U}\).
    \begin{enumerate}
        \item \(n = 0\) 则 \(G_\lambda ((0,x)) = G_\varnothing ((0,x)) = x\).
        \item \(n > 0\) 则 \(G_\lambda (x) = \ddot{G_{\lambda(0)}} (G_{\lambda \circ \vec{0}} (x \circ \vec{0}), G_{\lambda \circ \vec{1}} (x \circ \vec{1}))\).
    \end{enumerate}
\end{definition}

\begin{corollary}
    有 \(G^{\circ n} (x) = \bigcup \{G_\lambda (x^{2^n}) : (\lambda : 2^{< n} \to 9)\}\).
    
    于是 \(G^{\circ \omega} (x) = \bigcup_{n \in \omega} \bigcup_{\lambda \in 9^{2^n}} G_\lambda[x]\).
\end{corollary}

\begin{definition}[Gödel]
    在 \(\mathfrak{L}\) 上定义典范良序 \(\mathfrak{W}\), 注意到

    \[
        L_\alpha = \bigcup_{\beta \in \alpha} \bigcup_{n \in \omega} \bigcup_{\lambda \in 9^{2^{<n}} \mathcal{P} (L_\beta)} G_\lambda [{(L_\beta \cup \{L_\beta\})}^{2^n}]
    \]

    先定义在 \(2^{< \omega}\) 与 \(9^{\star} = \bigcup_{n \in \omega} 9^{2^{< n}}\) 上的典范序 \(<_2\) 与 \(<_9\):

    \begin{enumerate}
        \item \(\abs{f} < \abs{g}\)
        \item \(\exists i \in \mathbf{dom} (f) = \mathbf{dom} (g) ((f \upharpoonright i = g \upharpoonright i) \land (f(i) < g(i)))\)
    \end{enumerate}

    \begin{enumerate}
        \item \(\abs{f} < \abs{g}\)
        \item \(\exists s \in \mathbf{dom} (f) = \mathbf{dom} (g) ((f \upharpoonright 2^{< \omega} (s) = g \upharpoonright 2^{\omega}(s)) \land (f(s) <_2 g(s)))\)
    \end{enumerate}

    于是定义 \(L_\alpha\) 上的良序 

    \begin{enumerate}
        \item \(\alpha\) 是极限序数 \(W_\alpha := \bigcup_{\beta \in \alpha} L_\beta \times (L_\alpha \setminus L_\beta) \cup (W_\beta \upharpoonright (L_{\beta + 1} \setminus L_\beta))\)
        \item \(\alpha = \beta + 1\) 时先定义 \(T_\beta := \bigcup_{n \in \omega} 9^{2^{<n}} \times {(L_\beta \cup \{L_\beta\})}^{2^n}\) 上的良序 \((\lambda,f) < (\mu,g)\) 当且仅当
        \begin{enumerate}
            \item \(\lambda <_9 \mu\)
            \item \(\lambda = \mu\) 且 \(\exists s \in \mathbf{dom} (\lambda) (f \upharpoonright 2^{< \omega} (s) = g \upharpoonright 2^{< \omega} (s) \land f(s) <_\beta g(s))\)
        \end{enumerate}
        其中 \(<_\beta := W_\beta \cup (L_\beta \times \{L_\beta\})\).
        令 \(W_\alpha := W_\beta \cup (L_\beta \times (L_\alpha \setminus L_\beta)) \cup \{(a,b) \in (L_\alpha \setminus L_\beta) \times (L_\alpha \setminus L_\beta) : \exists (\lambda,f) \in T_\beta (a = G_\lambda (f) \land \forall (\mu,g) \in T_\beta (b = G_\mu (g) \implies (\lambda,f) < (\mu,g)))\}\).
    \end{enumerate}

    取并集延拓至 \(\mathfrak{L}\) 即为所求.
\end{definition}

\begin{axiom}[Axiom of Constructibility]
    \setlabel {Axiom of Constructibility}
    \label {axiom:Axiom of Constructibility}
    \(\mathfrak{L} = \mathfrak{U}\).
\end{axiom}

\begin{lemma}
    \ref{axiom:Axiom of Constructibility} 可以推出 \ref{axiom:NBG Axiom of Foundation} 和 \ref{axiom:NBG Axiom of Global Choice}.

    \begin{proof}
        有 \(\mathfrak{L} \subseteq \mathfrak{V} \subseteq \mathfrak{U}\) 只能全取等号.
        
        选择函数利用 \(\mathfrak{L}\) 上的典范良序构造即可.
    \end{proof}
\end{lemma}

仿此思路, 亦可定义对类的操作, 此种自举的想法, 在逻辑研究中非常重要, 剩余的讨论依旧遗留在高等集合论中讨论.
